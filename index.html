<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Spotify Login</title>
</head>
<body>
  <h1>Spotify Top 10</h1>
  <button onclick="redirectToSpotifyAuth()">Login mit Spotify</button>

  <script src="pkce.js"></script>
  <script>
    const clientId = '70a2baab0a314a94a7489048e10cf0b1';
    const redirectUri = 'https://astral-alt.github.io/Spotifsongs/callback.html';
    const scopes = 'user-top-read';

    async function redirectToSpotifyAuth() {
      const codeVerifier = generateCodeVerifier();
      const codeChallenge = await generateCodeChallenge(codeVerifier);

      localStorage.setItem('code_verifier', codeVerifier);

      const authUrl = `https://accounts.spotify.com/authorize?` +
        `client_id=${clientId}&response_type=code` +
        `&redirect_uri=${encodeURIComponent(redirectUri)}` +
        `&scope=${encodeURIComponent(scopes)}` +
        `&code_challenge_method=S256&code_challenge=${codeChallenge}`;

      window.location.href = authUrl;
    }
  </script>
</body>
</html>

